<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="question">

<!-- 리스트 뽑을거 -->
	<select id="selectAll" resultType="QuestionDTO" parameterType="map">
		SELECT tg.gosu_number,question_number, tu.user_number, question_title, question_content, question_date, question_viewcnt, question_status, last_update
		FROM tbl_question tq 
		join tbl_user tu 
		join tbl_gosu tg
		on tq.user_number = tu.user_number 
		where tg.gosu_number = tq.gosu_number and tg.gosu_number=#{gosuNumber}
		order by question_date asc 
		limit #{startRow}, #{rowCount} 
	</select>
	
<!-- 답변완료..였던것 -->
	<select id="selectAll2" resultType="QuestionDTO" parameterType="map">
		SELECT tg.gosu_number,question_number, tu.user_number, question_title, question_content, question_date, question_viewcnt, question_status, last_update
		FROM tbl_question tq 
		join tbl_user tu 
		join tbl_gosu tg
		on tq.user_number = tu.user_number 
		where tg.gosu_number = tq.gosu_number and tg.gosu_number=#{gosuNumber}
		order by question_date asc 
		limit #{startRow}, #{rowCount} 
	</select>
	
<!-- 페이징처리였던것 -->
	<select id="getTotal" resultType="_int">
		select count(question_number) from tbl_question
	</select>
	
<!-- 닉네임 뽑을거 -->
	<select id="selectNickName" resultType="string">
		SELECT user_nickname 
		FROM tbl_user tu join tbl_gosu tg 
		ON tu.user_number = tg.user_number 
		WHERE tg.gosu_number = #{gosuNumber}
	</select>
	
<!-- 질문쓰기 -->
	<insert id="insert" parameterType="QuestionDTO" >
		insert into tbl_question
		(question_title,question_content,user_number,gosu_number)
		values(#{questionTitle}, #{questionContent}, #{userNumber}, #{gosuNumber});
	</insert>
	
	
</mapper>